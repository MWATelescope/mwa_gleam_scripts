

<html>
<link rel="stylesheet" type="text/css" href="eorlive.css">
<head>
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script src="jquery-latest.js"></script>
  <script type="text/javascript">
    

    google.load("visualization", "1", {'packages':['table']});

    function loadLog()
    {
    
    

    var queryText=encodeURIComponent('select A,B,C,D,E');
    <!--var key='0Au_2bmQn8fR4dHFqb0VwNHpKdjBoWFZrVzV3dm8zenc';-->
    var key='0Ate0sqkDCwhydEpHMnlHckFSRjRhaE5IdHFUcDd2enc'
    var query = new google.visualization.Query('http://spreadsheets.google.com/a/google.com/tq?key='+key+'&tq='+queryText);
    document.getElementById("obslog").innerHTML="http://spreadsheets.google.com/a/google.com/tq?key="+key+"&tq="+queryText;
    
    query.send(
    function(response){
    if (response.isError()) {
    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
    }
    var data = response.getDataTable();
    var table = new google.visualization.Table(document.getElementById("obslog"));
    table.draw(data, {showRowNumber: false, width: 1000});
    });
    }


    

    function createXHR()
    {
    try{
    return new XMLHttpRequest();
    }
    catch(e) {
    try {
    return new ActiveXObject("Microsoft.XMLHTTP");
    }
    catch(e) {
    return new ActiveXObject("Msxml2.XMLHTTP");
    }
    }
    }

    <!-- This Function get's the time of the next Observation-->
    function getNextObs()
    {
    var xhr=createXHR();
    xhr.onreadystatechange=function()
    {
    if(xhr.status==200 && xhr.readyState==4)
    {
    document.getElementById("nextobs").innerHTML=xhr.responseText;
    }
    }
    xhr.open("GET","NextG9Obs.php",true);
    xhr.send();
    }

    function recentData()
    {
    var xhr = createXHR();
    xhr.onreadystatechange=function()
    {
    if(xhr.status==200 && xhr.readyState==4)
    {
    document.getElementById("LastData").innerHTML=xhr.responseText;
    }
    };
    xhr.open("GET","LastData.php",true);
    xhr.send();
    }



    function showG9()
    {
    var xhr = createXHR();
    xhr.onreadystatechange=function()
    {
    if(xhr.status==200 && xhr.readyState==4)
    {
    document.getElementById("G9Div").innerHTML=xhr.responseText;
    }
    };
    xhr.open("GET","G9Total.php",true);
    xhr.send();
    }
    
    function getTime()
    {
    var xhr=createXHR();
    xhr.onreadystatechange=function()
    {
    if(xhr.status==200 && xhr.readyState==4)
    {
    var timestr=xhr.responseText;
    var bostonTime=timestr.substr(0,19);
    var phoenixTime=timestr.substr(19,19);
    var sydneyTime=timestr.substr(38,19);
    var bangaloreTime=timestr.substr(57,19);
    var perthTime=timestr.substr(76,19);
    document.getElementById("timeBoston").innerHTML=bostonTime;
    document.getElementById("timePhoenix").innerHTML=phoenixTime;
    document.getElementById("timeSydney").innerHTML=sydneyTime;
    document.getElementById("timeBangalore").innerHTML=bangaloreTime;
    document.getElementById("timeMWA").innerHTML=perthTime;
    }
    };
    xhr.open("GET","ServerTime.php",true);
    xhr.send();
    }
    
    function getG9Day()
    {
    var xhr=createXHR()
    xhr.onreadystatechange=function()
    {
    if(xhr.status==200 && xhr.readyState==4)
    {
    document.getElementById("DayCount").innerHTML=xhr.responseText;
    }
    };
    xhr.open("GET","G9DayCount.php",true);
    xhr.send();
    }

    function getG9()
    {
    var xhr=createXHR()
    xhr.onreadystatechange=function()
    {
    if(xhr.status==200 && xhr.readyState==4)
    {
    document.getElementById("TotCount").innerHTML=xhr.responseText;
    }
    };
    xhr.open("GET","G9Count.php",true);
    xhr.send();
    }
    

    function commandCount()
    {
    var xhr=createXHR();
    xhr.onreadystatechange=function()
    {
    if(xhr.status==200 && xhr.readyState==4)
    {
    document.getElementById("commandCount").innerHTML=xhr.responseText;
    }
    };
    xhr.open("GET","CommandCount.php",true);
    xhr.send();
    }
    
    function goodCount(rx_id)
    {
    rx_id=rx_id.toString();
    var xhr=createXHR();
    xhr.onreadystatechange=function()
    {
    if(xhr.status==200 && xhr.readyState==4)
    {
    document.getElementById("goodCount"+rx_id).innerHTML=xhr.responseText;
    }
    };
    xhr.open("GET","GoodCount.php?rx_id="+rx_id,true);
    xhr.send();
    }


    function diskSpace()
    {
    var xhr=createXHR();
    xhr.onreadystatechange=function()
    {
    if(xhr.status==200 && xhr.readyState==4)
    {
    document.getElementById("diskSpace").innerHTML=xhr.responseText;
    }
    };
    xhr.open("GET","DiskSpace.php");
    xhr.send();
    }


    function goodCounts()
    {
    for(var i = 1; i<=16; i++)
			  {
			  goodCount(i);
			  }
			  }
			  
			  function init()
			  {
			  getTime();
			  getNextObs();
			  getG9Day();
			  getG9();
			  }
			  window.onload=init();
			 google.setOnLoadCallback(loadLog);
			 var refresh1=window.setInterval("getTime()",1000);
			 var refresh2=window.setInterval("getNextObs()",60000);
			 var refresh3=window.setInterval("getG9Day()",60000);
			 var refresh4=window.setInterval("getG9()",60000);
  </script>
</head>

<body>
<div id="title" class="title">
<h1> EoR Observing Webpage </h1>
</div>
<table class="timetable" id="timetable">
<tr> <th class="timeth"> Boston </th> <th class="timeth"> Pheonix </th> <th class="timeth"> Sidney </th> <th class="timeth"> Bangalore </th> <th class="timeth"> MWA Site </th></tr>
<tr> <td id="timeBoston" class="time">Loading...</td><td id="timePhoenix" class="time">Loading... </td> <td id="timeSydney">Loading...</td><td id="timeBangalore" class="time">Loading...</td><td id="timeMWA">Loading...</td></tr>
</table>
<table>
<tr>
<td id="nextobstitle" class="nextobs">
<font size="5">Next Observation in :</font> 
</td>
<td id="nextobs" class="nextobs">
</td>
</tr>
<tr>
<td class="nextobs">
Next 24 Hours
</td>
<td class="nextobs">
Total Queued
</td>
</tr>
<tr>
<td id="DayCount" class="nextobs">

</td>
<td id="TotCount" class="nextobs">
</td>
</tr>
</table>
<table>
<tr>
<td id="obslog" class="obslog" colspan="2">
Loading...
</td>
</tr>
<tr>
<td colspan="2">
<a class="button" href="https://docs.google.com/forms/d/1TbSXkRDUajoVls3tg6df9ZoJsnCf0Eu5LD2juNPEn0M/viewform" target="_blank">Make a Log Entry!</a>
</td>
</tr>
<tr class="plotwrapper"><td id="timeplot" class="plot"><iframe width="500" height="300" scrolling="no" frameborder="no" src="https://www.google.com/fusiontables/embedviz?containerId=gviz_canvas&amp;viz=GVIZ&amp;t=LINE_AGGREGATE&amp;isXyPlot=true&amp;bsize=0&amp;q=select+col0%2C+col4%2C+col5%2C+col1+from+1UspWE7G7ccKncYTUbEkpSaSitomsN-7vLkNdx-I&amp;qrs=+where+col0+%3E%3D+&amp;qre=+and+col0+%3C%3D+&amp;qe=+order+by+col0+asc&amp;uiversion=2&amp;gco_forceIFrame=true&amp;gco_hasLabelsColumn=true&amp;width=500&amp;height=300"></iframe></td>
<td id="rxplot" class="plot"><iframe width="500" height="300" scrolling="no" frameborder="no" src="https://www.google.com/fusiontables/embedviz?containerId=gviz_canvas&amp;viz=GVIZ&amp;t=LINE_AGGREGATE&amp;isXyPlot=true&amp;bsize=0&amp;q=select+col0%2C+col7%2C+col6%2C+col8%2C+col9%2C+col10%2C+col11%2C+col12%2C+col13%2C+col14%2C+col15%2C+col16%2C+col18%2C+col19%2C+col20%2C+col21+from+1UspWE7G7ccKncYTUbEkpSaSitomsN-7vLkNdx-I&amp;qrs=+where+col0+%3E%3D+&amp;qre=+and+col0+%3C%3D+&amp;qe=+order+by+col0+asc&amp;uiversion=2&amp;gco_forceIFrame=true&amp;gco_hasLabelsColumn=true&amp;width=500&amp;height=300"></iframe></td></tr>
</table>

</body>
</html>
